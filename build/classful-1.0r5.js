'use strict';(function(g){var h=function(){var g=function(a){var b=!1;a.init||(b=!0,a.init=function(){c.__metadata__.extend&&this.__super__()});a.initSingleton=!1;var c=function(){if(c.__metadata__.singleton&&!a.initSingleton)throw"Cannot instantiate a singleton. Use getInstance() method instead.";var b=void 0!==this&&this!==window?this:Object.create(c.prototype);a.self=b;a.instantiating=!0;c.__metadata__.init.apply(b,arguments);a.instantiating=!1;if(a.sup&&!a.sup.__metadata__.defaultConstructor)throw"The constructor of the super class must be called explicitly.";
return b};a.singleton&&i(c,a);Object.defineProperty(c,"__metadata__",{value:Object.defineProperties(Object.create(Object.prototype),{fullyQualifiedName:{value:a.fullyQualifiedName,enumerable:!0,writable:!0},singleton:{value:a.singleton,enumerable:!0,writable:!0},properties:{value:a.properties,enumerable:!0,writable:!0},init:{value:a.init,enumerable:!0,writable:!0},defaultConstructor:{value:b,enumerable:!0,writable:!0},extend:{value:a.extend,enumerable:!0}})});a.extend&&h(c,a);for(var d in a.properties)c.prototype[d]=
a.properties[d];return c},h=function(a,b){a.prototype=Object.create(b.extend.prototype);Object.defineProperties(a.prototype,{constructor:{value:a},__super__:{value:function(){var a=b.extend,c;return function(){if(!b.instantiating)throw"Super constructor can only be called inside the constructor.";if(!a)throw"Cannot call the super constructor because the class does not extend from any other class.";c=a;a=a.__metadata__.extend;b.sup=a;c.prototype.constructor.apply(this,arguments);a||(a=b.extend)}}(),
configurable:!0}});var c=b.extend,d;for(d in b.extend.prototype)"function"===typeof b.extend.prototype[d]&&Object.defineProperty(a.prototype.__super__,d,{value:function(a){var d;return function(){if(!c)throw'Cannot call the super property "'+a+'" because the class does not extend from any other class.';d=c;c=c.__metadata__.extend;var e=d.prototype[a].apply(b.self,arguments);c=d;return e}}(d)})},i=function(a,b){Object.defineProperty(a,"getInstance",{value:function(){var c;return function(){c||(b.initSingleton=
!0,c=new a,b.initSingleton=!1);return c}}(),enumerable:!0,configurable:!0})},m=function(a,b){void 0!==b.singleton&&b.singleton!==a.__metadata__.singleton&&(b.singleton?(i(a,b),a.__metadata__.singleton=!0):(delete a.getInstance,a.__metadata__.singleton=!1));b.init||(a.__metadata__.defaultConstructor=!0,b.init=function(){a.__metadata__.extend&&this.__super__()});a.__metadata__.init=b.init;if(void 0!==b.fullyQualifiedName&&b.fullyQualifiedName!==a.__metadata__.fullyQualifiedName)if(b.fullyQualifiedName){if(a.__metadata__.fullyQualifiedName){var c=
a.__metadata__.fullyQualifiedName.split(".");delete e.using[c[c.length-1]]}e.using[b.name]=a;a.__metadata__.fullyQualifiedName=b.fullyQualifiedName}else c=a.__metadata__.fullyQualifiedName.split("."),delete e.using[c[c.length-1]];void 0===b.properties&&a.__metadata__.properties&&(b.properties=a.__metadata__.properties);if(void 0!==b.properties){if(b.properties||null===b.properties)for(var d in a.__metadata__.properties)delete a.prototype[d];if(null!==b.properties)for(d in b.properties)a.prototype[d]=
b.properties[d];else b.properties={};a.__metadata__.properties=b.properties}},f={},j=function(a){if(!/^[a-z_][\w_]*$/i.test(a))throw"Invalid class name.";return e.string?e.string+"."+a:a},k=function(a){a=e(e.using,a,!1)||e(f,a,!1);return a instanceof Function?a:null},e=function(a,b,c){void 0===c&&(c=!1);for(var b=b.split("."),d=0,e=b.length;d<e;d++){var f=a[b[d]]||(c?{}:null);if(!f)return null;a=a[b[d]]=f}return a};e.using=f;e.string="";var l=function(a){if("string"===typeof a&&(a=k(a),!a))throw"Class not found.";
return a};return{create:function(a){var b={fullyQualifiedName:null,properties:{},init:null,extend:null,singleton:!1},c=!1;if(a&&(void 0!==a.singleton&&(b.singleton=a.singleton),void 0!==a.name&&(b.fullyQualifiedName=j(a.name),c=!0),void 0!==a.constructor&&a.constructor!==Object&&(b.init=a.constructor),void 0!==a.properties&&(b.properties=a.properties),void 0!==a.extend&&(b.extend=l(a.extend),b.extend.__metadata__.singleton)))throw"Cannot extend a singleton.";b=g(b);c&&(e.using[a.name]=b);return b},
getClassByName:k,getNamespace:function(a){if(!a)return f;a=e(f,a,!1);return a instanceof Function?null:a},namespace:function(a){a?(e.string=a,e.using=e(f,a,!0)):(e.string="",e.using=f)},update:function(a,b){if(b){var a=l(a),c={fullyQualifiedName:void 0,name:b.name,properties:void 0,init:a.__metadata__.init,singleton:void 0};void 0!==b.name&&(c.fullyQualifiedName=null===b.name?null:j(b.name));void 0!==b.constructor&&b.constructor!==Object&&(c.init=b.constructor);void 0!==b.properties&&(c.properties=
b.properties);if(b.augment){c.properties||(c.properties=a.__metadata__.properties);for(var d in b.augment)c.properties[d]=b.augment[d]}void 0!==b.singleton&&(c.singleton=b.singleton);m(a,c)}}}}();g.Class=h})(this);
